<div class="row">
  <div class="col-md-12">
    <div class="card">
      <div class="card-header d-flex justify-content-between align-items-center">
        <h3 class="card-title">Serviços</h3>
        <%= link_to new_service_path, class: 'btn btn-primary btn-sm' do %>
          <i class="fas fa-plus"></i> Novo Serviço
        <% end %>
      </div>
      <div class="card-body">
        <%= form_tag services_path, method: :get, class: 'mb-4' do %>
          <div class="row">
            <div class="col-md-4">
              <div class="form-group">
                <%= text_field_tag :search, params[:search], class: 'form-control', placeholder: 'Buscar por código, nome...' %>
              </div>
            </div>
            <div class="col-md-3">
              <div class="form-group">
                <%= select_tag :category_id, 
                    options_from_collection_for_select(current_tenant.categories.order(:name), :id, :name, params[:category_id]), 
                    include_blank: 'Todas as categorias', 
                    class: 'form-control' %>
              </div>
            </div>
            <div class="col-md-3">
              <div class="form-group">
                <%= select_tag :service_type,
                    options_for_select(Service.service_types.map { |k, v| [t("enums.service.service_type.#{k}"), k] }, params[:service_type]),
                    include_blank: 'Todos os tipos',
                    class: 'form-control' %>
              </div>
            </div>
            <div class="col-md-2">
              <div class="form-group">
                <%= submit_tag 'Filtrar', class: 'btn btn-primary' %>
                <%= link_to 'Limpar', services_path, class: 'btn btn-secondary ml-2' %>
              </div>
            </div>
          </div>
        <% end %>
        <div class="table-responsive">
          <table class="table table-striped table-hover">
            <thead>
              <tr>
                <th>Código</th>
                <th>Nome</th>
                <th>Categoria</th>
                <th>Tipo</th>
                <th>Unidade</th>
                <th>Preço</th>
                <th>Status</th>
                <th>Ações</th>
              </tr>
            </thead>
            <tbody>
              <% @services.each do |service| %>
                <tr>
                  <td><%= service.code %></td>
                  <td><%= service.name %></td>
                  <td><%= service.category&.name %></td>
                  <td><%= t("enums.service.service_type.#{service.service_type}") %></td>
                  <td><%= service.unit %></td>
                  <td><%= number_to_currency(service.price) %></td>
                  <td>
                    <span class="badge badge-<%= service.active? ? 'success' : 'danger' %>">
                      <%= t("enums.service.status.#{service.status}") %>
                    </span>
                  </td>
                  <td>
                    <div class="btn-group">
                      <%= link_to service_path(service), class: 'btn btn-info btn-sm', title: 'Visualizar' do %>
                        <i class="fas fa-eye"></i>
                      <% end %>
                      <%= link_to edit_service_path(service), class: 'btn btn-primary btn-sm', title: 'Editar' do %>
                        <i class="fas fa-edit"></i>
                      <% end %>
                      <%= link_to service_path(service), method: :delete, data: { confirm: 'Tem certeza que deseja excluir este serviço?' }, class: 'btn btn-danger btn-sm', title: 'Excluir' do %>
                        <i class="fas fa-trash"></i>
                      <% end %>
                    </div>
                  </td>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>
        <div class="d-flex justify-content-center">
          <%= paginate @services %>
        </div>
      </div>
    </div>
  </div>
</div> 